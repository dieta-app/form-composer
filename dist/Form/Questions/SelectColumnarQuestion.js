"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports.SelectColumnarQuestion=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends"));var _toConsumableArray2=_interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _assertThisInitialized2=_interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));var _inherits2=_interopRequireDefault(require("@babel/runtime/helpers/inherits"));var _possibleConstructorReturn2=_interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));var _getPrototypeOf2=_interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));var _defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));var _react=_interopRequireWildcard(require("react"));var _styledComponents=_interopRequireWildcard(require("styled-components"));var _propTypes=_interopRequireDefault(require("prop-types"));var _FormProvider=require("../FormProvider");var _color=_interopRequireDefault(require("color"));var _jsxFileName="/Users/bneigher/Desktop/Dieta/form-composer/src/Form/Questions/SelectColumnarQuestion.js";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){(0,_defineProperty2.default)(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=(0,_getPrototypeOf2.default)(Derived),result;if(hasNativeReflectConstruct){var NewTarget=(0,_getPrototypeOf2.default)(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return(0,_possibleConstructorReturn2.default)(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}var fadeIn=(0,_styledComponents.keyframes)(["0%{opacity:0;box-shadow:0 0 0 0px rgba(0,0,0,0.2);}100%{opacity:1;box-shadow:0 0 0 25px rgba(0,0,0,0);}"]);var checkmark=(0,_styledComponents.keyframes)(["0%{height:0;width:0;opacity:0;}20%{height:0;width:calc(3em/4);}40%{}100%{height:calc(3.5em/2);width:calc(3em/4);opacity:1;}"]);var StyledQuestionContainer=_styledComponents.default.div.withConfig({displayName:"StyledQuestionContainer",componentId:"f51l5h-0"})(["display:flex;flex:1;flex-direction:column;min-width:275px;margin-bottom:70px;"]);var DecisionIndicator=_styledComponents.default.div.withConfig({displayName:"DecisionIndicator",componentId:"f51l5h-1"})(["display:flex;align-items:center;justify-content:center;flex:1;margin:auto;margin-top:10px;margin-bottom:10px;width:15px;height:15px;border-color:",";border-style:solid;border-width:1px;border-radius:50px;&.selected{border-color:",";&::before{animation:"," 0.2s linear;content:\"\";display:inline-block;width:9px;height:9px;border-radius:5px;background-color:",";margin:auto;}}"],function(props){return props.theme.colors.MID;},function(props){return props.theme.colors.PRIMARY_LIGHT;},fadeIn,function(props){return props.theme.colors.PRIMARY_LIGHT;});var DecisionContainer=_styledComponents.default.div.withConfig({displayName:"DecisionContainer",componentId:"f51l5h-2"})(["font-size:14px;display:flex;flex:8;font-family:proxima-nova;user-select:none;align-items:center;justify-content:center;text-align:center;"]);var StyledTable=_styledComponents.default.table.withConfig({displayName:"StyledTable",componentId:"f51l5h-3"})(["width:100%;tbody > tr td:nth-of-type(even){background-color:#eee;}thead > tr th:nth-of-type(even) div{background-color:#eee;}"]);var StyledTableHeader=_styledComponents.default.th.withConfig({displayName:"StyledTableHeader",componentId:"f51l5h-4"})(["font-size:12px;padding:0 10px;&.rotate{height:100px;min-width:30px;max-width:50px;position:relative;vertical-align:bottom;padding:0;font-size:11px;line-height:1;> div{position:relative;top:0px;left:-50px;height:100%;transform:skew(45deg,0deg);overflow:hidden;}> div > span{transform:skew(-45deg,0deg) rotate(45deg);position:relative;top:calc(50% - 10px);left:0;bottom:0;right:0;display:inline-block;text-align:left;width:100px;@media (max-width:471px){left:-50%;}@media (min-width:472px) and (max-width:676px){left:-25%;}}}"]);var StyledTableData=_styledComponents.default.td.withConfig({displayName:"StyledTableData",componentId:"f51l5h-5"})([""]);var QuestionContainer=function(_Component){(0,_inherits2.default)(QuestionContainer,_Component);var _super=_createSuper(QuestionContainer);function QuestionContainer(){var _this;(0,_classCallCheck2.default)(this,QuestionContainer);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"state",{step:_this.props.step});return _this;}(0,_createClass2.default)(QuestionContainer,[{key:"populateWithDefaults",value:function populateWithDefaults(){var _this2=this;if(this.props.step===this.props.context.activeStateContent.step){var componentProps=this.props.context.activeStateContent&&this.props.context.activeStateContent.component&&this.props.context.activeStateContent.component.props;var defaultSelected=componentProps&&componentProps.defaultSelected;if(Object(componentProps).hasOwnProperty("defaultSelected")){if(this.props.columns&&this.props.columns.length){var pagedQuestions=this.props.context.states.filter(function(state){return state.question===_this2.props.context.activeStateContent.question&&state.step!==_this2.props.context.activeStateContent.step;});var initialStateQuestions=pagedQuestions.reduce(function(acc,item){if(item.answer){Object.keys(item.answer).forEach(function(answer){acc[answer]=item.answer[answer];});}return acc;},{});this.props.choices.forEach(function(choice){if(!_this2.props.answer[choice.option]){initialStateQuestions[choice.option]=defaultSelected;}});[].concat((0,_toConsumableArray2.default)(pagedQuestions.map(function(state){return state.step;})),[this.props.context.activeState]).forEach(function(step){_this2.props.context.setStateAnswer(step,_objectSpread(_objectSpread({},_this2.props.answer),initialStateQuestions));});this.props.context.markStateComplete(this.props.context.activeState,{answer:_objectSpread(_objectSpread({},this.props.answer),initialStateQuestions)});}}}this.setState({step:this.props.step});}},{key:"componentDidMount",value:function componentDidMount(){this.populateWithDefaults();}},{key:"componentDidUpdate",value:function componentDidUpdate(){if(this.props.step!==this.state.step){this.populateWithDefaults();}}},{key:"render",value:function render(){return _react.default.createElement(StyledQuestionContainer,{__source:{fileName:_jsxFileName,lineNumber:224,columnNumber:7}},this.props.children);}}]);return QuestionContainer;}(_react.Component);var ChoiceContainer=function(_Component2){(0,_inherits2.default)(ChoiceContainer,_Component2);var _super2=_createSuper(ChoiceContainer);function ChoiceContainer(){(0,_classCallCheck2.default)(this,ChoiceContainer);return _super2.apply(this,arguments);}(0,_createClass2.default)(ChoiceContainer,[{key:"render",value:function render(){var _this3=this;return _react.default.createElement("tr",{__source:{fileName:_jsxFileName,lineNumber:246,columnNumber:7}},_react.default.createElement(StyledTableData,{style:{border:0},__source:{fileName:_jsxFileName,lineNumber:247,columnNumber:9}},_react.default.createElement(DecisionContainer,{style:{maxWidth:"150px"},__source:{fileName:_jsxFileName,lineNumber:248,columnNumber:11}},this.props.option)),this.props.columns.map(function(choice,index){return _react.default.createElement(StyledTableData,{key:index,onClick:function onClick(){return _this3.props.onSelect(_this3.props.option,choice);},__source:{fileName:_jsxFileName,lineNumber:254,columnNumber:13}},_react.default.createElement(DecisionIndicator,{selected:_this3.props.answer[_this3.props.option]===choice,className:_this3.props.answer[_this3.props.option]===choice?"selected":"",__source:{fileName:_jsxFileName,lineNumber:258,columnNumber:15}}));}));}}]);return ChoiceContainer;}(_react.Component);(0,_defineProperty2.default)(ChoiceContainer,"propTypes",{answer:_propTypes.default.object.isRequired,columns:_propTypes.default.array.isRequired,option:_propTypes.default.string.isRequired,onSelect:_propTypes.default.func.isRequired});(0,_defineProperty2.default)(ChoiceContainer,"defaultProps",{answer:{},columns:[],option:"",onSelect:function onSelect(){}});var SelectColumnarQuestion=function(_Component3){(0,_inherits2.default)(SelectColumnarQuestion,_Component3);var _super3=_createSuper(SelectColumnarQuestion);function SelectColumnarQuestion(){var _this4;(0,_classCallCheck2.default)(this,SelectColumnarQuestion);for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2];}_this4=_super3.call.apply(_super3,[this].concat(args));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this4),"onClick",function(question,response,cb,context){if(!context.static){var dictionary=context.activeStateContent.answer||{};dictionary[response.option]=response.choice;var pagedQuestions=context.states.filter(function(state){return state.question===context.activeStateContent.question&&state.step!==context.activeStateContent.step;});pagedQuestions.forEach(function(state){context.setStateAnswer(state.step,dictionary);});if(cb&&typeof cb==="function"){cb({question:question,answer:dictionary},context);}}});return _this4;}(0,_createClass2.default)(SelectColumnarQuestion,[{key:"componentDidMount",value:function componentDidMount(){}},{key:"componentDidUpdate",value:function componentDidUpdate(){}},{key:"render",value:function render(){var _this5=this;return _react.default.createElement(_styledComponents.ThemeContext.Consumer,{__source:{fileName:_jsxFileName,lineNumber:329,columnNumber:7}},function(themeContext){return _react.default.createElement(_FormProvider.FormConsumer,{__source:{fileName:_jsxFileName,lineNumber:332,columnNumber:13}},function(context){return _react.default.createElement(QuestionContainer,(0,_extends2.default)({step:context.activeStateContent.step,context:context},_this5.props,{__source:{fileName:_jsxFileName,lineNumber:335,columnNumber:19}}),_react.default.createElement(StyledTable,{style:{overflow:"scroll"},__source:{fileName:_jsxFileName,lineNumber:340,columnNumber:21}},_react.default.createElement("thead",{__source:{fileName:_jsxFileName,lineNumber:341,columnNumber:23}},_react.default.createElement("tr",{__source:{fileName:_jsxFileName,lineNumber:342,columnNumber:25}},_react.default.createElement(StyledTableHeader,{style:{border:0,maxWidth:"150px"},__source:{fileName:_jsxFileName,lineNumber:343,columnNumber:27}}),_this5.props.columns.map(function(choice,index){return _react.default.createElement(StyledTableHeader,{className:"rotate",key:index,__source:{fileName:_jsxFileName,lineNumber:348,columnNumber:31}},_react.default.createElement("div",{__source:{fileName:_jsxFileName,lineNumber:352,columnNumber:33}},_react.default.createElement("span",{__source:{fileName:_jsxFileName,lineNumber:353,columnNumber:35}},choice)));}))),_react.default.createElement("tbody",{__source:{fileName:_jsxFileName,lineNumber:360,columnNumber:23}},_this5.props.choices.map(function(choice,index){return _react.default.createElement(ChoiceContainer,(0,_extends2.default)({context:context,key:index,answer:_this5.props.answer,columns:_this5.props.columns},choice,{onSelect:function onSelect(option,choice){return _this5.onClick(context.activeStateContent.question,{option:option,choice:choice},context.cb,context);},__source:{fileName:_jsxFileName,lineNumber:363,columnNumber:29}}));}))));});});}}]);return SelectColumnarQuestion;}(_react.Component);exports.SelectColumnarQuestion=SelectColumnarQuestion;(0,_defineProperty2.default)(SelectColumnarQuestion,"propTypes",{answer:_propTypes.default.object.isRequired,columns:_propTypes.default.array.isRequired,choices:_propTypes.default.array.isRequired,defaultSelected:_propTypes.default.oneOfType([_propTypes.default.string,_propTypes.default.number])});(0,_defineProperty2.default)(SelectColumnarQuestion,"defaultProps",{answer:{},columns:[],choices:[],defaultSelected:null});(0,_defineProperty2.default)(SelectColumnarQuestion,"containerProps",{fullScreen:true});